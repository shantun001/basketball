app.controller("PSController",["$timeout","$rootScope","$scope","$compile","psService","PlayerSearchService","$location","headerService","$window",PlayerSearchController]);
function PlayerSearchController(l,c,a,g,e,m,h,n,p){function k(){a.tempTableData=a.playerListData.slice();a.currentPage=a.paging.current;a.previousCount=10*a.currentPage-10;a.nextCount=10*a.currentPage;a.playersPagin=a.tempTableData.slice(a.previousCount,a.nextCount);l(a.$apply)}a.queryData={season:"",league:"",positions:"",country:""};a.querData={season:"",league:""};a.playerListData=null;a.redirectToPlayers=function(){h.path("/playersearch/players")};$("#loader-container-players").fadeOut(4500);
    a.setSeasonId=function(b,d){a.seasonId.id=b;c.choiceSeason=d;a.tableParams=n.getParams()};a.updateSeasonSelect=function(){e.getSeasons().then(function(b){for(var d="",f=0;f<b.length;f++){d=d+'<option value="'+b[f].id+'">'+b[f].name+"</option>";var c=g(d)(a);$("#search-season").html(c);$("#search-season").selectpicker("refresh");$("#search-position").selectpicker();$("#search-country").selectpicker();$("#search-league").selectpicker()}$("#search-season").on("changed.bs.select",function(b){b.preventDefault();
        a.queryData.season=$("#search-season").val();a.updateLeagueSelect(Number(b.target.value));a.updateCountriesSelect()})})};a.updateLeagueSelect=function(b){e.getLeagues(b).then(function(b){b.sort(function(a,b){if(a.name>b.name)return 1;if(a.name<b.name)return-1});for(var d="",c=0;c<b.length;c++){d=d+'<option value="'+b[c].id+'">'+b[c].name+"</option>";var q=g(d)(a);$("#search-league").html(q).selectpicker("refresh")}$("#search-league").on("changed.bs.select",function(b){b.preventDefault();b.stopImmediatePropagation();
        a.queryData.league=$("#search-league").val()||[];a.updateCountriesSelect()})})};a.updateCountriesSelect=function(){$("#search-country").html("").selectpicker("refresh");e.getCountries(a.queryData.season||null,a.queryData.league||null).then(function(b){for(var d="",c=0;c<b.length;c++){d=d+'<option value="'+b[c].id+'">'+b[c].name+"</option>";var e=g(d)(a);$("#search-country").html(e).selectpicker("refresh")}$("#search-country").on("changed.bs.select",function(b){b.preventDefault();b.stopImmediatePropagation();
        a.queryData.country=$("#search-country").val()||[]})})};$("#search-position").on("changed.bs.select",function(b){b.preventDefault();b.stopImmediatePropagation();a.queryData.positions=$("#search-position").val()||[]});var r=$("#rangeslider").kendoRangeSlider({min:150,max:220,smallStep:1,largeStep:10,tickPlacement:"both",tooltip:{format:""},change:function(b){a.heightId=r.value()}}).data("kendoRangeSlider"),t=$("#rangeslider2").kendoRangeSlider({min:15,max:45,smallStep:1,largeStep:10,tickPlacement:"both",
            tooltip:{format:""},change:function(b){a.ageId=t.value()}}).data("kendoRangeSlider"),u=$("#slider1").kendoSlider({increaseButtonTitle:"Right",decreaseButtonTitle:"Left",min:0,max:15,smallStep:.5,largeStep:5,change:function(){a.fgmId=u.value()},width:300}).data("kendoSlider"),v=$("#slider2").kendoSlider({increaseButtonTitle:"Right",decreaseButtonTitle:"Left",min:0,max:15,smallStep:.5,largeStep:5,change:function(){a.fgaId=v.value()},width:300}).data("kendoSlider"),w=$("#slider3").kendoSlider({increaseButtonTitle:"Right",
            decreaseButtonTitle:"Left",min:0,max:100,smallStep:1,largeStep:25,change:function(){a.fgId=w.value()},width:300}).data("kendoSlider"),x=$("#slider4").kendoSlider({increaseButtonTitle:"Right",decreaseButtonTitle:"Left",min:0,max:15,smallStep:.5,largeStep:5,change:function(){a.n3pmId=x.value()},width:300}).data("kendoSlider"),y=$("#slider5").kendoSlider({increaseButtonTitle:"Right",decreaseButtonTitle:"Left",min:0,max:15,smallStep:.5,largeStep:5,change:function(){a.n3paId=y.value()},width:300}).data("kendoSlider"),
        z=$("#slider6").kendoSlider({increaseButtonTitle:"Right",decreaseButtonTitle:"Left",min:0,max:100,smallStep:1,largeStep:25,change:function(){a.n3pId=z.value()},width:300}).data("kendoSlider"),A=$("#slider7").kendoSlider({increaseButtonTitle:"Right",decreaseButtonTitle:"Left",min:0,max:15,smallStep:.5,largeStep:5,change:function(){a.n2pmId=A.value()},width:300}).data("kendoSlider"),B=$("#slider8").kendoSlider({increaseButtonTitle:"Right",decreaseButtonTitle:"Left",min:0,max:15,smallStep:.5,largeStep:5,
            change:function(){a.n2paId=B.value()},width:300}).data("kendoSlider"),C=$("#slider9").kendoSlider({increaseButtonTitle:"Right",decreaseButtonTitle:"Left",min:0,max:100,smallStep:1,largeStep:25,change:function(){a.n2pId=C.value()},width:300}).data("kendoSlider"),D=$("#slider10").kendoSlider({increaseButtonTitle:"Right",decreaseButtonTitle:"Left",min:0,max:15,smallStep:.5,largeStep:5,change:function(){a.ftmId=D.value()},width:300}).data("kendoSlider"),E=$("#slider11").kendoSlider({increaseButtonTitle:"Right",
            decreaseButtonTitle:"Left",min:0,max:15,smallStep:.5,largeStep:5,change:function(){a.ftaId=E.value()},width:300}).data("kendoSlider"),F=$("#slider12").kendoSlider({increaseButtonTitle:"Right",decreaseButtonTitle:"Left",min:0,max:100,smallStep:1,largeStep:25,change:function(){a.ftId=F.value()},width:300}).data("kendoSlider"),G=$("#slider13").kendoSlider({increaseButtonTitle:"Right",decreaseButtonTitle:"Left",min:0,max:15,smallStep:.5,largeStep:5,change:function(){a.orId=G.value()},width:300}).data("kendoSlider"),
        H=$("#slider14").kendoSlider({increaseButtonTitle:"Right",decreaseButtonTitle:"Left",min:0,max:15,smallStep:.5,largeStep:5,change:function(){a.drId=H.value()},width:300}).data("kendoSlider"),I=$("#slider15").kendoSlider({increaseButtonTitle:"Right",decreaseButtonTitle:"Left",min:0,max:15,smallStep:.5,largeStep:5,change:function(){a.trId=I.value()},width:300}).data("kendoSlider"),J=$("#slider16").kendoSlider({increaseButtonTitle:"Right",decreaseButtonTitle:"Left",min:0,max:15,smallStep:.5,largeStep:5,
            change:function(){a.asId=J.value()},width:300}).data("kendoSlider"),K=$("#slider17").kendoSlider({increaseButtonTitle:"Right",decreaseButtonTitle:"Left",min:0,max:15,smallStep:.5,largeStep:5,change:function(){a.toId=K.value()},width:300}).data("kendoSlider"),L=$("#slider18").kendoSlider({increaseButtonTitle:"Right",decreaseButtonTitle:"Left",min:0,max:15,smallStep:.5,largeStep:5,change:function(){a.stId=L.value()},width:300}).data("kendoSlider"),M=$("#slider19").kendoSlider({increaseButtonTitle:"Right",
            decreaseButtonTitle:"Left",min:0,max:15,smallStep:.5,largeStep:5,change:function(){a.ptsId=M.value()},width:300}).data("kendoSlider"),N=$("#slider20").kendoSlider({increaseButtonTitle:"Right",decreaseButtonTitle:"Left",min:0,max:40,smallStep:1,largeStep:10,change:function(){a.minId=N.value()},width:300}).data("kendoSlider"),O=$("#slider21").kendoSlider({increaseButtonTitle:"Right",decreaseButtonTitle:"Left",min:0,max:15,smallStep:.5,largeStep:5,change:function(){a.bsId=O.value()},width:300}).data("kendoSlider"),
        P=$("#slider22").kendoSlider({increaseButtonTitle:"Right",decreaseButtonTitle:"Left",min:0,max:15,smallStep:.5,largeStep:5,change:function(){a.valId=P.value()},width:300}).data("kendoSlider"),Q=$("#slider23").kendoSlider({increaseButtonTitle:"Right",decreaseButtonTitle:"Left",min:0,max:2,smallStep:.01,largeStep:.05,change:function(){a.oerId=Q.value()},width:500}).data("kendoSlider"),R=$("#slider24").kendoSlider({increaseButtonTitle:"Right",decreaseButtonTitle:"Left",min:0,max:2,smallStep:.01,largeStep:.05,
            change:function(){a.virId=R.value()},width:500}).data("kendoSlider");a.playerSortObj={name:"none",position:"none",height:"none",age:"none",pts:"none",tr:"none",astn:"none",team:"none",video:"none"};a.playerSort=function(b){a.playerSortObj[b]="none"==a.playerSortObj[b]?"down":"down"==a.playerSortObj[b]?"up":"none";for(var c in a.playerSortObj)c!=b&&(a.playerSortObj[c]="none");a.tableMarkup="";a.playerListData.length=0;switch(b){case "name":a.playerListData=a.nameSort.slice();break;case "position":a.playerListData=
        a.positionSort.slice();break;case "height":a.playerListData=a.heightSort.slice();break;case "age":a.playerListData=a.ageSort.slice();break;case "tr":a.playerListData=a.trSort.slice();break;case "astn":a.playerListData=a.astnSort.slice();break;case "pts":a.playerListData=a.ptsSort.slice();break;case "team":a.playerListData=a.teamSort.slice();break;case "video":a.playerListData=a.videoSort.slice()}switch(a.playerSortObj[""+b]){case "none":a.playerListData=a.playerListData.slice();break;case "up":a.playerListData=
        a.playerListData.reverse().slice()}k()};a.startSearch=function(b){b.preventDefault();b.stopImmediatePropagation();b=$("#search-season").val();var c=$("#search-league").val(),f=$("#search-country").val(),g=$("#search-position").val();e.searchPlayers(b,c,f,g,a.heightId,a.ageId,a.fgmId,a.fgaId,a.fgId,a.n3pmId,a.n3paId,a.n3pId,a.n2pmId,a.n2paId,a.n2pId,a.ftmId,a.ftaId,a.ftId,a.orId,a.drId,a.trId,a.asId,a.toId,a.stId,a.ptsId,a.minId,a.bsId,a.valId,a.oerId,a.virId).then(function(b){a.playerListData=b;a.tablePlayersData=
        a.playerListData.slice();a.nameSort=_.sortBy(a.playerListData,"player_last_name").slice();a.positionSort=_.sortBy(a.playerListData,"player_position").slice();a.heightSort=_.sortBy(a.playerListData,"player_height").slice();a.ageSort=_.sortBy(a.playerListData,"player_age").slice();a.trSort=_.sortBy(a.playerListData,"total_rebounds").slice();a.astnSort=_.sortBy(a.playerListData,"assists").slice();a.ptsSort=_.sortBy(a.playerListData,"points").slice();a.teamSort=_.sortBy(a.playerListData,"team_name").slice();
        a.videoSort=_.sortBy(a.playerListData,"videos.length").slice();a.currentPage=0;a.previousCount=0;a.nextCount=0;a.paging={total:Math.ceil(parseFloat(a.playerListData.length/10)),current:1,onPageChanged:k}});a.paging=a.playersPagin.slice(10)};a.getPlayerData=function(a){m.getPlayerById(a).then(function(a){c.playerProfile=a;c.goldSubscription||c.isAdmin?p.open("player/"+c.playerProfile.id+"/"+c.playerProfile.last_name+"_"+c.playerProfile.first_name,"_blank"):h.path("player/"+c.playerProfile.id+"/"+c.playerProfile.last_name+
        "_"+c.playerProfile.first_name)})}};