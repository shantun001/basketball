app.controller("PRController",["$timeout","$rootScope","$scope","$compile","psService","PlayerSearchService","$location","headerService","$window",PlayerRankingsController]);
function PlayerRankingsController(k,c,a,f,e,l,g,m,n){function h(){a.tempTableData=a.playerListData.slice();a.currentPage=a.paging.current;a.previousCount=20*a.currentPage-20;a.nextCount=20*a.currentPage;a.playersPagin=a.tempTableData.slice(a.previousCount,a.nextCount);k(a.$apply)}a.queryData={season:"",league:"",positions:"",country:""};a.playerListData=null;a.redirectToPlayers=function(){g.path("/playersearch/players")};$("#loader-container-players").fadeOut(4500);a.setSeasonId=function(b,d){a.seasonId.id=
    b;c.choiceSeason=d;a.tableParams=m.getParams()};a.updateSeasonSelectRank=function(){e.getSeasons().then(function(b){for(var d="",c=0;c<b.length;c++){d=d+'<option value="'+b[c].id+'">'+b[c].name+"</option>";var p=f(d)(a);$("#search-season").html(p);$("#search-season").selectpicker("refresh");$("#search-league").selectpicker()}$("#search-season").on("changed.bs.select",function(b){b.preventDefault();a.queryData.season=$("#search-season").val();a.updateLeagueSelect(Number(b.target.value))})})};a.updateLeagueSelect=
    function(b){e.getLeagues(b).then(function(b){b.sort(function(a,b){if(a.name>b.name)return 1;if(a.name<b.name)return-1});for(var c="",d=0;d<b.length;d++){c=c+'<option value="'+b[d].id+'">'+b[d].name+"</option>";var e=f(c)(a);$("#search-league").html(e).selectpicker("refresh")}$("#search-league").on("changed.bs.select",function(b){b.preventDefault();b.stopImmediatePropagation();a.queryData.league=$("#search-league").val()||[]})})};a.playerSortObj={name:"none",position:"none",height:"none",age:"none",
    min:"none",pts:"none",s4ur:"none",oer:"none",vir:"none",val:"none",tr:"none",astn:"none",team:"none",video:"none"};a.playerSort=function(b){a.playerSortObj[b]="none"==a.playerSortObj[b]?"down":"down"==a.playerSortObj[b]?"up":"none";for(var c in a.playerSortObj)c!=b&&(a.playerSortObj[c]="none");a.tableMarkup="";a.playerListData.length=0;switch(b){case "name":a.playerListData=a.nameSort.slice();break;case "position":a.playerListData=a.positionSort.slice();break;case "height":a.playerListData=a.heightSort.slice();
    break;case "age":a.playerListData=a.ageSort.slice();break;case "tr":a.playerListData=a.trSort.slice();break;case "astn":a.playerListData=a.astnSort.slice();break;case "min":a.playerListData=a.minSort.slice();break;case "pts":a.playerListData=a.ptsSort.slice();break;case "s4ur":a.playerListData=a.s4urSort.slice();break;case "oer":a.playerListData=a.oerSort.slice();break;case "vir":a.playerListData=a.virSort.slice();break;case "val":a.playerListData=a.valSort.slice();break;case "team":a.playerListData=
    a.teamSort.slice();break;case "video":a.playerListData=a.videoSort.slice()}switch(a.playerSortObj[""+b]){case "none":a.playerListData=a.playerListData.slice();break;case "up":a.playerListData=a.playerListData.reverse().slice()}h()};a.startSearch=function(b){b.originalEvent.stopImmediatePropagation();b=$("#search-season").val();var c=$("#search-league").val();e.searchPlayers(b,c,a.heightId,a.ageId,a.fgmId,a.fgaId,a.fgId,a.n3pmId,a.n3paId,a.n3pId,a.n2pmId,a.n2paId,a.n2pId,a.ftmId,a.ftaId,a.ftId,a.orId,
    a.drId,a.trId,a.asId,a.toId,a.stId,a.ptsId,a.minId,a.bsId,a.valId,a.oerId,a.virId).then(function(b){a.playerListData=b;a.tablePlayersData=a.playerListData.slice();a.nameSort=_.sortBy(a.playerListData,"player_last_name").slice();a.positionSort=_.sortBy(a.playerListData,"player_position").slice();a.heightSort=_.sortBy(a.playerListData,"player_height").slice();a.ageSort=_.sortBy(a.playerListData,"player_age").slice();a.trSort=_.sortBy(a.playerListData,"total_rebounds").slice();a.astnSort=_.sortBy(a.playerListData,
    "assists").slice();a.minSort=_.sortBy(a.playerListData,"minutes").slice();a.ptsSort=_.sortBy(a.playerListData,"points").slice();a.s4urSort=_.sortBy(a.playerListData,"s4ur").slice();a.oerSort=_.sortBy(a.playerListData,"oer").slice();a.virSort=_.sortBy(a.playerListData,"vir").slice();a.valSort=_.sortBy(a.playerListData,"val").slice();a.teamSort=_.sortBy(a.playerListData,"team_name").slice();a.videoSort=_.sortBy(a.playerListData,"videos.length").slice();a.currentPage=0;a.previousCount=0;a.nextCount=
    0;a.paging={total:Math.ceil(parseFloat(a.playerListData.length/20)),current:1,onPageChanged:h}});a.paging=a.playersPagin.slice(20)};a.getPlayerData=function(a){l.getPlayerById(a).then(function(a){c.playerProfile=a;c.goldSubscription||c.isAdmin?n.open("player/"+c.playerProfile.id+"/"+c.playerProfile.last_name+"_"+c.playerProfile.first_name,"_blank"):g.path("player/"+c.playerProfile.id+"/"+c.playerProfile.last_name+"_"+c.playerProfile.first_name)})}};