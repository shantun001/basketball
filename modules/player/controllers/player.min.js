function PlayerProfileController(e,t,a,n,r,i,o,s){function l(){i.getCounter(n.playerInfo.id).then(function(e){n.playerId=e.page_views,i.setCounter(n.playerInfo.id)})}function d(e){return e.slice(8,e.indexOf("/",8))}a.playerProfile?(n.playerInfo=a.playerProfile,$("#loader-container-player").fadeOut(200),l()):i.getPlayerById(d(window.location.pathname)).then(function(e){n.playerInfo=e,$("#loader-container-player").fadeOut(200),l()}),n.player=a.playerProfile?a.playerProfile.id:d(window.location.pathname),n.careerData={},n.selectedTab="career stats",n.seasonAverages={},n.rankOptions={},n.rankOptSelected={},n.selectedRank="",n.seasonOptions=[],n.statOptions={},n.selectedSeason="",a.isTendencyDrawn=!1,n.tendencyInitiated=!1,n.tendencyObj={tendencySelected:-1,startSearch:!1,games:[],isDef:function(e){return-1!==[1,2,3,4,6,9,12,17,19,21,25,26,29,30,33].indexOf(e)?"offence":24===e?"other":"defence"},seasons:[]},n.videos=[],n.currentVideo="",n.statTablesArr=[];var p,c=[];function m(e,t){if(void 0===t||""==t)return e.toString();var a=e.split("-"),n=t.split("-");return new Date(a[0],a[1],a[2])>new Date(n[0],n[1],n[2])?e.toString():t.toString()}function f(e,t){var a=e/t*100;return isNaN(a)?0:Number.isInteger(a)?a:parseFloat(a.toString().match(/^-?\d+(?:\.\d{0,1})?/)[0])}function _(e,a){var r;document.getElementById("playClipsModal").classList.remove("full_screen"),n.videos=e,n.selectedVideo=new Array(e.length).fill("").map(function(){return!1}),r=a,n.videos=n.videos.map(function(e){var t={};return t.url=3===e.processed?"https://d3hkpco91lv4dz.cloudfront.net/clips/"+encodeURI(e.file_name)+"/original.mp4":"https://d3hkpco91lv4dz.cloudfront.net/clips/"+encodeURI(e.file_name)+".mp4",t.actionname=r||c[e.action],3===e.processed&&e.file_name.includes("/")?t.img="https://d3hkpco91lv4dz.cloudfront.net/clips/"+e.file_name+"/"+e.file_name.slice(e.file_name.indexOf("/")+7)+".jpg":3===e.processed?t.img="https://d3hkpco91lv4dz.cloudfront.net/clips/"+e.file_name+"/"+e.file_name+".jpg":t.img="https://d3hkpco91lv4dz.cloudfront.net/clips/"+e.file_name+".jpg",t}),n.currentVideo=n.videos[0];var i=document.getElementById("clip");i.hidden=!1,i.controls=!0,i.style.width="100%",i.autoplay=!0,i.playbackRate=1,i.onended=function(){n.nextClip(),t(function(){n.$apply()})},p=document.addEventListener("click",function(e){e.target===document.querySelector("div#playClipsModal.modal.fade")&&($("#playClipsModal").modal("hide"),i.pause())})}n.getAge=function(e){return e?(new Date).getFullYear()-new Date(e).getFullYear():""},n.selectAllVideos=function(){n.selectedVideo=n.selectedVideo.map(function(e,t){return t<=19}),console.log(n.selectedVideo)},n.deSelectAllVideos=function(){n.selectedVideo=n.selectedVideo.map(function(){return!1})},n.toggleSelectVideo=function(e){n.selectedVideo[e]=!n.selectedVideo[e]},n.exportVideosToFolder=function(){var e=prompt("Please enter name of the folder here"),t="";i.createFolder(e).then(function(e){t=e.id,n.videos.filter(function(e,t){return n.selectedVideo[t]}).forEach(function(e,a){var n="";n=e.url.includes("original")?e.url.slice(e.url.indexOf("clips/")+6,e.url.indexOf("/original.mp4")):e.url.slice(e.url.indexOf("clips/")+6,e.url.indexOf(".mp4")),i.uploadVideosToFolder(t,e.actionname+" - "+(a+1),n).then(function(e){})})})},n.initiateCareerView=function(){i.getCareer(n.player).then(function(e){n.playerInfoChartData=e.filter(function(e){return"average"===e.league_name||"average"===e.country_name})[0],n.rankOptions=e.filter(function(e){return"average"!==e.league_name||"average"!==e.country_name}),n.selectedRank=n.rankOptions[0].season+","+n.rankOptions[0].league+","+n.rankOptions[0].team,e.forEach(function(e){n.careerData.hasOwnProperty(e.season_name)?n.careerData[e.season_name].push(e):(n.careerData[e.season_name]=[],n.careerData[e.season_name].push(e))}),n.careerData.seasons=Object.keys(n.careerData),n.selectedSeason=n.careerData.seasons[0],function(){var e=n.playerInfoChartData;e.ft_percent=e.ft_attempts?(100*e.ft_made/e.ft_attempts).toFixed(1):0,e.p2_percent=e.p2_attempts?(100*e.p2_made/e.p2_attempts).toFixed(1):0,e.p3_percent=e.p3_attempts?(100*e.p3_made/e.p3_attempts).toFixed(1):0,e.fg_percent=e.fg_attempts?(100*e.fg_made/e.fg_attempts).toFixed(1):0;var t=e.ft_percent>80?"#257f36":e.ft_percent<80&&e.ft_percent>70?"#cdc720":"#bc0202",a=e.p2_percent>60?"#257f36":e.p2_percent<60&&e.p2_percent>45?"#cdc720":"#bc0202",r=e.p3_percent>37?"#257f36":e.p3_percent<37&&e.p3_percent>30?"#cdc720":"#bc0202",i=e.p3_percent>55?"#257f36":e.p3_percent<55&&e.p3_percent>45?"#cdc720":"#bc0202";$(".player-info-chart").kendoChart({series:[{name:"FT% = "+e.ft_percent,data:[e.ft_percent],color:t,labels:{visible:!0}},{name:"2P% = "+e.p2_percent,data:[e.p2_percent],color:a,labels:{visible:!0}},{name:"3P% = "+e.p3_percent,data:[e.p3_percent],color:r,labels:{visible:!0}},{name:"FG% = "+e.fg_percent,data:[e.fg_percent],color:i,labels:{visible:!0}}],tooltip:{visible:!0,background:"#000000",color:"#ffffff",padding:5,template:"${series.name}",font:"11px Arial,Helvetica,sans-serif"},chartArea:{width:500,height:200}})}();var t=[];for(b in e){var a=e[b];-1==$.inArray(a.season,t)&&(t.push(a.season),n.seasonOptions.push({dist:!0,value:a.season+","+a.league+","+a.team,label:a.season_name}))}})},angular.element(document).ready(function(){n.initiateCareerView()}),i.getTaggedSeasons(n.player).then(function(e){n.tendencyObj.seasons=e.sort(function(e,t){return e.id-t.id})}),n.initiateRankView=function(){$("#rank-select").selectpicker(),$("#rank-select").on("changed.bs.select",function(e){n.drawRank(e.target.value)}),n.drawRank()},n.drawRank=function(e){var t=e||$("#rank-select").val();i.getPlayerRankData(n.player,t).then(function(e){!function(e){var t=e[0],a=[];t.player.points&&a.push([t.player.points.toFixed(1),t.player.points_league_rank,t.player.points_team_rank,"PTS",t.league.points.toFixed(1),t.team.points.toFixed(1)]);t.player.val&&a.push([t.player.val.toFixed(1),t.player.val_league_rank,t.player.val_team_rank,"VAL",t.league.val.toFixed(1),t.team.val.toFixed(1)]);t.player.oer&&a.push([t.player.oer.toFixed(2),t.player.oer_league_rank,t.player.oer_team_rank,"OER",t.league.oer.toFixed(2),t.team.oer.toFixed(2)]);t.player.vir&&a.push([t.player.vir.toFixed(2),t.player.vir_league_rank,t.player.vir_team_rank,"VIR",t.league.vir.toFixed(2),t.team.vir.toFixed(2)]);t.player.ft_percent&&a.push([t.player.ft_percent.toFixed(1),t.player.ft_percent_league_rank,t.player.ft_percent_team_rank,"FT%",t.league.ft_percent.toFixed(1),t.team.ft_percent.toFixed(1)]);t.player.p2_percent&&a.push([t.player.p2_percent.toFixed(1),t.player.p2_percent_league_rank,t.player.p2_percent_team_rank,"2P%",t.league.p2_percent.toFixed(1),t.team.p2_percent.toFixed(1)]);t.player.p3_percent&&a.push([t.player.p3_percent.toFixed(1),t.player.p3_percent_league_rank,t.player.p3_percent_team_rank,"3P%",t.league.p3_percent.toFixed(1),t.team.p3_percent.toFixed(1)]);t.player.fg_percent&&a.push([t.player.fg_percent.toFixed(1),t.player.fg_percent_league_rank,t.player.fg_percent_team_rank,"FG%",t.league.fg_percent.toFixed(1),t.team.fg_percent.toFixed(1)]);t.player.ft_made&&a.push([t.player.ft_made.toFixed(1),t.player.ft_made_league_rank,t.player.ft_made_team_rank,"FTM",t.league.ft_made.toFixed(1),t.team.ft_made.toFixed(1)]);t.player.p2_made&&a.push([t.player.p2_made.toFixed(1),t.player.p2_made_league_rank,t.player.p2_made_team_rank,"2PM",t.league.p2_made.toFixed(1),t.team.p2_made.toFixed(1)]);t.player.p3_made&&a.push([t.player.p3_made.toFixed(1),t.player.p3_made_league_rank,t.player.p3_made_team_rank,"3PM",t.league.p3_made.toFixed(1),t.team.p3_made.toFixed(1)]);t.player.fg_made&&a.push([t.player.fg_made.toFixed(1),t.player.fg_made_league_rank,t.player.fg_made_team_rank,"FGM",t.league.fg_made.toFixed(1),t.team.fg_made.toFixed(1)]);t.player.ft_attempts&&a.push([t.player.ft_attempts.toFixed(1),t.player.ft_attempts_league_rank,t.player.ft_attempts_team_rank,"FTA",t.league.ft_attempts.toFixed(1),t.team.ft_attempts.toFixed(1)]);t.player.p2_attempts&&a.push([t.player.p2_attempts.toFixed(1),t.player.p2_attempts_league_rank,t.player.p2_attempts_team_rank,"2PA",t.league.p2_attempts.toFixed(1),t.team.p2_attempts.toFixed(1)]);t.player.p3_attempts&&a.push([t.player.p3_attempts.toFixed(1),t.player.p3_attempts_league_rank,t.player.p3_attempts_team_rank,"3PA",t.league.p3_attempts.toFixed(1),t.team.p3_attempts.toFixed(1)]);t.player.fg_attempts&&a.push([t.player.fg_attempts.toFixed(1),t.player.fg_attempts_league_rank,t.player.fg_attempts_team_rank,"FGA",t.league.fg_attempts.toFixed(1),t.team.fg_attempts.toFixed(1)]);t.player.assists&&a.push([t.player.assists.toFixed(1),t.player.assists_league_rank,t.player.assists_team_rank,"AS",t.league.assists.toFixed(1),t.team.assists.toFixed(1)]);t.player.turnovers&&a.push([t.player.turnovers.toFixed(1),t.player.turnovers_league_rank,t.player.turnovers_team_rank,"TO",t.league.turnovers.toFixed(1),t.team.turnovers.toFixed(1)]);t.player.steals&&a.push([t.player.steals.toFixed(1),t.player.steals_league_rank,t.player.steals_team_rank,"ST",t.league.steals.toFixed(1),t.team.steals.toFixed(1)]);t.player.block_shots&&a.push([t.player.block_shots.toFixed(1),t.player.block_shots_league_rank,t.player.block_shots_team_rank,"BS",t.league.block_shots.toFixed(1),t.team.block_shots.toFixed(1)]);t.player.df_rebounds&&a.push([t.player.df_rebounds.toFixed(1),t.player.df_rebounds_league_rank,t.player.df_rebounds_team_rank,"DR",t.league.df_rebounds.toFixed(1),t.team.df_rebounds.toFixed(1)]);t.player.of_rebounds&&a.push([t.player.of_rebounds.toFixed(1),t.player.of_rebounds_league_rank,t.player.of_rebounds_team_rank,"OR",t.league.of_rebounds.toFixed(1),t.team.of_rebounds.toFixed(1)]);t.player.fouls_made&&a.push([t.player.fouls_made.toFixed(1),t.player.fouls_made_league_rank,t.player.fouls_made_team_rank,"FM",t.league.fouls_made.toFixed(1),t.team.fouls_made.toFixed(1)]);t.player.fouls_received&&a.push([t.player.fouls_received.toFixed(1),t.player.fouls_received_league_rank,t.player.fouls_received_team_rank,"FR",t.league.fouls_received.toFixed(1),t.team.fouls_received.toFixed(1)]);for(var n=0;n<a.length;n++){var r=parseFloat(a[n][0])>parseFloat(a[n][4])&&parseFloat(a[n][0])>parseFloat(a[n][5])?"#257f36":parseFloat(a[n][0])>parseFloat(a[n][4])||parseFloat(a[n][0])>parseFloat(a[n][5])?"#cdc720":"#bc0202",i="#257f36"===r?"https://s3.amazonaws.com/s4usitesimages/images/Green.png":"#cdc720"===r?"https://s3.amazonaws.com/s4usitesimages/images/Yellow.png":"https://s3.amazonaws.com/s4usitesimages/images/Red.png";$(".rank-chart-"+(n+1)).kendoChart({valueAxis:{labels:{font:"10px Arial,Helvetica,sans-serif"}},title:{text:"League rank: # "+a[n][1]+" in "+a[n][3]+"\nTeam rank: # "+a[n][2]+" in "+a[n][3],font:"13px Arial,Helvetica,sans-serif",color:"black",align:"left",margin:{left:57}},legend:{font:"10px Arial,Helvetica,sans-serif",position:"bottom"},series:[{name:"League",data:[a[n][4]],color:"#d6d8d8",labels:{visible:!0}},{name:"Team",data:[a[n][5]],color:"#545555",labels:{visible:!0}},{name:"Player",data:[a[n][0]],color:r,labels:{visible:!0}}]}),$(".chart-rank-cont-"+(n+1)+" img").attr({src:i}),$(".chart-rank-cont-"+(n+1)+" img").show()}}(e)})},n.initiateStatView=function(){$("#stat-select").selectpicker(),$("#stat-select").on("changed.bs.select",function(e){n.drawStat(e.target.value)}),n.drawStat()},n.drawStat=function(e){var t=e?e.split(","):$("#stat-select").val().split(",");function a(e,t){var a="";for(j in e){var n=1;e[j].minutes_numeral>0&&(n*=1/e[j].minutes_numeral,40==t&&(n*=40)),a=a+"<tr><td>"+(n*e[j].points).toFixed(1)+"</td><td>"+(n*e[j].fg_made).toFixed(1)+"</td><td>"+(n*e[j].fg_attempts).toFixed(1)+"</td><td>"+(n*e[j].p3_made).toFixed(1)+"</td><td>"+(n*e[j].p3_attempts).toFixed(1)+"</td><td>"+(n*e[j].p2_made).toFixed(1)+"</td><td>"+(n*e[j].p2_attempts).toFixed(1)+"</td><td>"+(n*e[j].ft_made).toFixed(1)+"</td><td>"+(n*e[j].ft_attempts).toFixed(1)+"</td><td>"+(n*e[j].of_rebounds).toFixed(1)+"</td><td>"+(n*e[j].df_rebounds).toFixed(1)+"</td><td>"+(n*e[j].points).toFixed(1)+"</td><td>"+(n*e[j].assists).toFixed(1)+"</td><td>"+(n*e[j].turnovers).toFixed(1)+"</td><td>"+(n*e[j].steals).toFixed(1)+"</td><td>"+(n*e[j].block_shots).toFixed(1)+"</td><td>"+(n*e[j].fouls_made).toFixed(1)+"</td><td>"+(n*e[j].fouls_received).toFixed(1)+"</td>"}return a}i.playerStatAnalysis(n.player,t[0],"by_game").then(function(e){!function(e){if(e.length>0){for(var t=e,a=[],n=[],r=[],i=[],o=0;o<t.length;o++)a.push(t[o].minutes_numeral.toFixed(1)),n.push(t[o].points.toFixed(1)),r.push((40*t[o].points/t[o].minutes_numeral).toFixed(1)),i.push(t[o].op_team_name);$("#chartContainerTab3").kendoChart({series:[{name:"Minutes",type:"column",color:"#000000",data:a},{name:"Points",type:"line",color:"blue",data:n},{name:"Points per 40 min",type:"line",color:"grey",data:r}],categoryAxis:{categories:i},chartArea:{width:1100,height:400},tooltip:{visible:!0,shared:!0,background:"#000000",color:"#ffffff",padding:5,font:"11px Arial,Helvetica,sans-serif"},legend:{position:"bottom"}})}}(e)}),i.playerStatAnalysis(n.player,t[0],"season_breakdown").then(function(e){var a,r;r=[],(a=e).forEach(function(e){e.fg_percent||(e.fg_percent=e.fg_attempts?100*e.fg_made/e.fg_attempts:0),e.p3_percent||(e.p3_percent=e.p3_attempts?100*e.p3_made/e.p3_attempts:0),e.p2_percent||(e.p2_percent=e.p2_attempts?100*e.p2_made/e.p2_attempts:0),e.ft_percent||(e.ft_percent=e.ft_attempts?100*e.ft_made/e.ft_attempts:0)}),a.forEach(function(e){"home"===e.row_type?r[0]=e:"away"===e.row_type?r[1]=e:"lost"===e.row_type?r[3]=e:r[2]=e}),r.push(n.seasonAverages[t[0]]),n.statTablesArr[0]={name:"BREAKDOWN",data:r}}),i.playerStatAnalysis(n.player,t[0],"by_month").then(function(e){!function(e){e.forEach(function(e){e.fg_percent||(e.fg_percent=e.fg_attempts?100*e.fg_made/e.fg_attempts:0),e.p3_percent||(e.p3_percent=e.p3_attempts?100*e.p3_made/e.p3_attempts:0),e.p2_percent||(e.p2_percent=e.p2_attempts?100*e.p2_made/e.p2_attempts:0),e.ft_percent||(e.ft_percent=e.ft_attempts?100*e.ft_made/e.ft_attempts:0)});var a=["January","February","March","April","May","June","July","August","September","October","November","December"];e.forEach(function(e){e.row_type=a[e.month-1]}),e.push(n.seasonAverages[t[0]]),n.statTablesArr[1]={name:"STATS PER MONTH",data:e}}(e)}),i.playerStatAnalysis(n.player,t[0],"league_breakdown").then(function(e){!function(e){e.forEach(function(e){e.fg_percent||(e.fg_percent=e.fg_attempts?100*e.fg_made/e.fg_attempts:0),e.p3_percent||(e.p3_percent=e.p3_attempts?100*e.p3_made/e.p3_attempts:0),e.p2_percent||(e.p2_percent=e.p2_attempts?100*e.p2_made/e.p2_attempts:0),e.ft_percent||(e.ft_percent=e.ft_attempts?100*e.ft_made/e.ft_attempts:0)});var t={};e.forEach(function(e){t[e.league_name]||(t[e.league_name]=[]),t[e.league_name].push(e)}),n.leagueStatsData=t}(e)}),i.playerStatAnalysis(n.player,$("#stat-select").val(),"season_stats").then(function(e){if(e.length>0){var t=a(e,1);$("#stat_per_min").html(t);var n=a(e,40);$("#stat_per_40min").html(n)}})},n.initiateBestWorstView=function(){$("#best-worst-select").selectpicker(),$("#best-worst-select").on("changed.bs.select",function(e){n.drawBestWorstView(e.target.value)}),n.drawBestWorstView()},n.drawBestWorstView=function(e){var t=e||$("#best-worst-select").val();i.playerStatAnalysis(n.player,t,"by_game").then(function(e){!function(e){var t={max:{},min:{}};$(".best_worst_game_wpr").html("");var a="<table class='table'><thead><tr class='how_gm'><td colspan='4'><span class='glyphicon glyphicon-thumbs-up'></span> <span>Best</span></td><td colspan='3'><span class='glyphicon glyphicon-thumbs-down'></span> <span>Worst</span></td></tr><tr><td></td><td>Value</td><td>Date</td><td>Opponent Team</td><td>Value</td><td>Date</td><td>Opponent Team</td></tr></thead><tbody></tbody></table>";if($(".best_worst_game_wpr").html(a),e.length>0){for(var i in e){var o=e[i],s=0,l=0,d=0,p=0;o.fg_attempts>=2&&(s=f(o.fg_made,o.fg_attempts)),o.p3_attempts>=2&&(d=f(o.p3_made,o.p3_attempts)),o.p2_attempts>=2&&(p=f(o.p2_made,o.p2_attempts)),o.ft_attempts>=2&&(l=f(o.ft_made,o.ft_attempts)),o.fg_per=s,o.p3_per=d,o.p2_per=p,o.ft_per=l,o.fg_per_unit="% ("+o.fg_made+"/"+o.fg_attempts+")",o.p3_per_unit="% ("+o.p3_made+"/"+o.p3_attempts+")",o.p2_per_unit="% ("+o.p2_made+"/"+o.p2_attempts+")",o.ft_per_unit="% ("+o.ft_made+"/"+o.ft_attempts+")",o.fg_per_made=o.fg_made,o.p3_per_made=o.p3_made,o.p2_per_made=o.p2_made,o.ft_per_made=o.ft_made,o.fg_per_attempts=o.fg_attempts,o.p3_per_attempts=o.p3_attempts,o.p2_per_attempts=o.p2_attempts,o.ft_per_attempts=o.ft_attempts,o.total_rebound=o.of_rebounds+o.df_rebounds,o.id=o.game_id;for(var c in o)"id"!==c&&(void 0===t.max[c]&&(t.max[c]={val:0,date:"",team:"",made:"",attempts:"",pre_date:"",id:o.id}),void 0===t.min[c]&&(t.min[c]={val:o[c],date:"",team:"",made:"",attempts:"",pre_date:"",id:o.id}),t.min[c].val>=o[c]&&(t.min[c].val=o[c],t.min[c].date=o.game_date,t.min[c].team=o.op_team_name,t.min[c].id=o.id,"fg_per"!=c&&"p3_per"!=c&&"p2_per"!=c&&"ft_per"!=c||(t.min[c].unit=o[c+"_unit"]),t.min[c].id=o.id),t.max[c].val<=o[c]&&(t.max[c].val=o[c],t.max[c].date=o.game_date,t.max[c].team=o.op_team_name,t.max[c].id=o.id,"fg_per"!=c&&"p3_per"!=c&&"p2_per"!=c&&"ft_per"!=c||o[c+"_made"]>t.max[c].made&&o[c+"_attempts"]>t.max[c].made&&(t.max[c].made=o[c+"_made"],t.max[c].attempts=o[c+"_attempts"],t.max[c].unit="% ("+o[c+"_made"]+"/"+o[c+"_attempts"]+")",t.max[c].id=o.id,t.max[c].made/t.max[c].attempts==o[c+"_made"]/o[c+"_attempts"]&&(t.max[c].date=m(o.game_date,t.max[c].pre_date),t.max[c].pre_date=o.game_date,t.max[c].id=o.id))))}var _={points:"PTS",fg_made:"FGM",fg_attempts:"FGA",fg_per:"FG%",p3_made:"3PM",p3_attempts:"3PA",p3_per:"3P%",p2_made:"2PM",p2_attempts:"2PA",p2_per:"2P%",ft_made:"FTM",ft_attempts:"FTA",ft_per:"FT%",of_rebounds:"OR",df_rebounds:"DR",total_rebound:"TR",assists:"AS",turnovers:"TO",steals:"ST",block_shots:"BS",shots_rejected:"SR",fouls_made:"FM",fouls_received:"FR",val:"VAL",vir:"VIR",oer:"OER"}}else var _={};if(e.length>0)for(var c in _){var u=t.min[c].date.split("-"),g=u[2]+"/"+u[1]+"/"+u[0],h=t.max[c].date.split("-"),y=h[2]+"/"+h[1]+"/"+h[0];a="fg_per"==c||"p3_per"==c||"p2_per"==c||"ft_per"==c?"<tr data-toggle='modal' data-target='#boxScoreModalPlayer' ng-click='handleModal($event, true)'><td>"+_[c]+"</td><td data-id="+t.max[c].id+">"+t.max[c].val+t.max[c].unit+"</td><td data-id="+t.max[c].id+">"+y+"</td><td data-id="+t.max[c].id+">"+t.max[c].team+"</td><td data-id="+t.min[c].id+">"+t.min[c].val+t.min[c].unit+"</td><td data-id="+t.min[c].id+">"+g+"</td><td data-id="+t.min[c].id+">"+t.min[c].team+"</td></tr>":"vir"==c||"oer"==c?"<tr data-toggle='modal' data-target='#boxScoreModalPlayer' ng-click='handleModal($event, true)'><td >"+_[c]+"</td><td data-id="+t.max[c].id+">"+t.max[c].val.toFixed(2)+"</td><td data-id="+t.max[c].id+">"+y+"</td><td data-id="+t.max[c].id+">"+t.max[c].team+"</td><td data-id="+t.min[c].id+">"+t.min[c].val.toFixed(2)+"</td><td data-id="+t.min[c].id+">"+g+"</td><td data-id="+t.min[c].id+">"+t.min[c].team+"</td></tr>":"<tr data-toggle='modal' data-target='#boxScoreModalPlayer' ng-click='handleModal($event, true)'><td>"+_[c]+"</td><td data-id="+t.max[c].id+">"+t.max[c].val+"</td><td data-id="+t.max[c].id+">"+y+"</td><td data-id="+t.max[c].id+">"+t.max[c].team+"</td><td data-id="+t.min[c].id+">"+t.min[c].val+"</td><td data-id="+t.min[c].id+">"+g+"</td><td data-id="+t.min[c].id+">"+t.min[c].team+"</td></tr>";var v=r(a)(n);$(".best_worst_game_wpr table").find("tbody").append(v)}else $(".best_worst_game_wpr table").find("tbody").append('<tr><td colspan="7">empty</tr>')}(e)})},n.initiateGameByGameView=function(){$("#game-by-game-select").selectpicker(),$("#game-by-game-select").on("changed.bs.select",function(e){n.drawGameByGame(e.target.value)}),n.drawGameByGame()},n.drawGameByGame=function(e){var t=e||$("#game-by-game-select").val();i.getGameByGame(n.player,t,"by_game").then(function(e){!function(e){var a={},r=n.rankOptions.filter(function(e){return e.season===Number(t.split(",")[0])&&e.league===Number(t.split(",")[1])})[0],i=[];e.forEach(function(e){a[e.step_name]||(a[e.step_name]=[],i.push(e.step_name)),a[e.step_name].push(e)});for(var o in a)a[o].forEach(function(e){e.fg_percent||(e.fg_percent=e.fg_attempts?e.fg_made/e.fg_attempts*100:0),e.p3_percent||(e.p3_percent=e.p3_attempts?e.p3_made/e.p3_attempts*100:0),e.p2_percent||(e.p2_percent=e.p2_attempts?e.p2_made/e.p2_attempts*100:0),e.ft_percent||(e.ft_percent=e.ft_attempts?e.ft_made/e.ft_attempts*100:0)});for(var s=0;s<i.length;s++){for(var o=a[i[s]],l={},d=0,p=0,c=0;c<o.length;c++)for(var m in o[c])if(o[c].hasOwnProperty(m)&&"number"==typeof o[c][m])l[m]=l[m]||0,l[m]=l[m]+o[c][m]/o.length;else if("minutes"===m){var f=o[c][m].split(":");d+=Number(new Date(0,0,0,0,Number(f[1]),Number(f[2]),0)),p=d/o.length}l.op_team_name="Average",l.minutes=new Date(p).toString().split(" ")[4].split(":").slice(1).join(":"),o.push(l)}r.op_team_name="Average",r.average=!0,a.Total=[r],a.leagueId=t.split(",")[1].trim(),a.seasonId=t.split(",")[0].trim(),n.gameByGameData=a}(e)})},n.initiateWatchGamesView=function(){$("#watch-games-select").selectpicker(),$("#watch-games-select").on("changed.bs.select",function(e){n.drawWatchGames(e.target.value)}),n.drawWatchGames()},n.drawWatchGames=function(e){var a=e?e.split(","):$("#watch-games-select").val().split(",");i.getPlayerVideo(n.player).then(function(e){!function(e){e=e.sort(function(e,t){return new Date(e.game_date)-new Date(t.game_date)});var r=[];n.nodata=!0;for(var i=!1,o=0;o<e.length;o++)if(e[o].season_id==a[0]&&e[o].league_id==a[1]){i=!0;var s=e[o].game_date.split("-");r.push({sid:e[o].season_id,league_name:e[o].leagues_name,game_date:s[2]+"/"+s[1]+"/"+s[0],home_team_id:e[o].home_team_id,home_team_name:e[o].home_team_name,away_team_name:e[o].away_team_name,away_team_id:e[o].away_team_id,game_id:e[o].game_id,season_id:e[o].season_id,league_id:e[o].league_id})}t(function(){n.norow=i,n.wgvideo=r,n.$apply()},0)}(e)})},n.watchVideo=function(e,t,a,r,i){o.getVideoTeam(e).then(function(e){var o;o=e,n.addSrc(o.video.video_server.http_path+o.video.link,o.video.game.home_team.id,o.video.game.away_team.id,o.video.game.home_team.name,o.video.game.away_team.name,t,a,r,i)})},n.closeWatchVideo=function(){document.getElementById("game_video_watch").pause()},n.addSrc=function(e,t,a,r,i,s,l,d,p){$("#game_video_watch").attr("src",e),$("#game_video_watch2").attr("href",e),n.homeName=r,n.awayName=i,o.getTeamForVideoNew(p,t).then(function(e){n.dataFirstTeam=e,n.gameDate=d}),o.getTeamForVideoNew(p,a).then(function(e){n.dataSecondTeam=e}).then(function(){setTimeout(function(){$("#open_video").fadeIn(10),$("#open_video").modal("show")},500)})},n.changeGauge=function(e){switch(e){case"all":n.tendencyObj.ofactions.show(),n.tendencyObj.defactions.show(),$('[ng-class="other"]').show(),$(".offence").show();break;case"def":n.tendencyObj.ofactions.hide(),n.tendencyObj.defactions.show(),$(".offence").hide(),$('[ng-class="other"]').hide();break;case"off":n.tendencyObj.defactions.hide(),n.tendencyObj.ofactions.show(),$(".offence").show(),$('[ng-class="other"]').hide()}},n.initiateTendencyView=function(){if(!n.tendencyInitiated){n.tendencyInitiated=!0;for(var e=n.tendencyObj.seasons,t="",a=0;a<e.length;a++)t=t+'<option value="'+e[a].id+'">'+e[a].name+"</option>";var o=r(t)(n);$(".tend-select").html(o),$(".tend-select").selectpicker("refresh");var s=!1;$(".tend-select").on("changed.bs.select",function(e){var t=Number(e.target.value);s||(s=!0,setTimeout(function(){s=!1},50),n.tendencyObj.tendencySelected=t,n.handleSeasonChange(t))}),i.getPlayerGames(n.player).then(function(e){var t=e,a="";for(var i in t){var o=t[i];a=a+'<option value="'+o.id+'">'+o.game_date+" "+o.home_team.name+" vs "+o.away_team.name+"</option>"}$("#profile-games-search").html("").selectpicker("refresh").selectpicker("val",null);var s=r(a)(n);$("#profile-games-search").html(s),$("#profile-games-search").selectpicker("refresh"),$("#profile-games-search").selectpicker("selectAll"),n.drawTendency(-1)})}},n.handleSeasonChange=function(e){-1===e?i.getPlayerGames(n.player).then(function(e){var t=e,a="";for(var i in t){var o=t[i];a=a+'<option value="'+o.id+'">'+o.game_date+" "+o.home_team.name+" vs "+o.away_team.name+"</option>"}$("#profile-games-search").html("").selectpicker("refresh").selectpicker("val",null);var s=r(a)(n);$("#profile-games-search").html(s),$("#profile-games-search").selectpicker("refresh"),$("#profile-games-search").selectpicker("selectAll"),$("#profile-games-search").selectpicker("refresh"),n.drawTendency(-1)}):i.getGamesBySeason(n.player,e).then(function(t){!function(t){for(var a="",i=0;i<t.length;i++)a=a+'<option value="'+t[i].id+'">'+t[i].game_date+" "+t[i].home_team.name+" vs "+t[i].away_team.name+"</option>";var o=r(a)(n);$("#profile-games-search").html(o),$("#profile-games-search").selectpicker("refresh"),$("#profile-games-search").selectpicker("selectAll"),$("#profile-games-search").selectpicker("refresh"),n.drawTendency(e)}(t)})},n.drawTendency=function(e){if(!a.isTendencyDrawn){a.isTendencyDrawn=!0,setTimeout(function(){a.isTendencyDrawn=!1},500);var t,r=$("#profile-games-search").val()||[];if(t=e?-1===e?null:e:-1===n.tendencyObj.tendencySelected?null:n.tendencyObj.tendencySelected,n.seasonquery=t,n.gamesquery=r,0!==n.gamesquery.length){document.querySelector(".display_none").style.display="block"}else document.querySelector(".display_none").style.display="none";i.getActions(n.player,t,r).then(function(e){var t,a;n.tendencyObj.actionsData=e,c=[],n.tendencyObj.actionsData.forEach(function(e){c[e.action]=e.name}),t=e,a=[],n.actionChartData=t.filter(function(e){return e.player>0}),n.actionChartData.forEach(function(e){a.push({name:e.player+" "+e.name,data:[e.player],labels:{visible:!0},color:"#"+(16777215*Math.random()<<0).toString(16)})}),$(".action-chart").kendoChart({valueAxis:{labels:{font:"1px Arial,Helvetica,sans-serif"}},title:{text:"Actions",font:"15px Arial,Helvetica,sans-serif",color:"black",align:"center"},legend:{font:"10px Arial,Helvetica,sans-serif"},series:a,tooltip:{visible:!0,background:"#000000",color:"#ffffff",padding:5,template:"${series.name.split(' ').slice(1).join(' ')} - ${value}",font:"11px Arial,Helvetica,sans-serif"}})}).then(function(e){return $(".shot-pie").kendoChart({title:{position:"top",margin:{top:1,right:1,bottom:1,left:1},padding:{top:1,right:1,bottom:1,left:1},text:Math.round(100*n.actionChartData[0].player/n.actionChartData[0].team)+"% of team shots "+n.actionChartData[0].player+"/"+n.actionChartData[0].team},legend:{visible:!0},chartArea:{background:"transparent",height:200,width:300},seriesDefaults:{labels:{visible:!1}},series:[{type:"pie",data:[{category:"Player Shots",value:n.actionChartData[0].player,color:"blue"},{category:"Team Shots",value:n.actionChartData[0].team,color:"red"}]}],tooltip:{visible:!0,background:"#000000",color:"#ffffff",padding:5,template:"${data.category} - ${value}",font:"13px Arial,Helvetica,sans-serif"}}),e}).then(function(e){return setTimeout(function(){for(var e=0;e<n.actionChartData.length;e++)new JustGage({id:"action-chart-"+e,value:100*n.actionChartData[e].player/n.actionChartData[e].team,min:0,max:100,label:"%",levelColors:["#bc0202","#cdc720","#257f36"]});$(".action-chart-title").show(),$(".action-chart-footer").show(),n.tendencyObj.defactions=$('[ng-class="defence"]'),n.tendencyObj.ofactions=$('[ng-class="offence"]')},0),e}),i.getShotsAnalysis(n.player,t,r).then(function(e){return function(e){n.shotGaugeData=e.filter(function(e){return Boolean(e.name)});for(var t,a=0,r=0,i=0,o=0;o<e.length;o++)null===e[o].name?(e[o].made,e[o].attempts):-1!==e[o].name.indexOf("Right")?a+=e[o].made+e[o].attempts:-1!==e[o].name.indexOf("Left")?r+=e[o].made+e[o].attempts:i+=e[o].made+e[o].attempts;t=a+r+i,$(".direction-chart").kendoChart({valueAxis:{labels:{font:"10px Arial,Helvetica,sans-serif"}},title:{text:"Direction Tendency",font:"15px Arial,Helvetica,sans-serif",color:"black",align:"center"},legend:{font:"10px Arial,Helvetica,sans-serif",position:"right"},series:[{name:Math.round(r/t*100)+"% Going Left",data:[Math.round(r/t*100)],color:"red",labels:{visible:!0}},{name:Math.round(a/t*100)+"% Going Right",data:[Math.round(a/t*100)],color:"blue",labels:{visible:!0}},{name:Math.round(i/t*100)+"% No direction",data:[Math.round(i/t*100)],color:"#d6d8d8",labels:{visible:!0}}],tooltip:{visible:!0,background:"#000000",color:"#ffffff",padding:5,template:"${series.name.split(' ').slice(1).join(' ')} - ${value}%",font:"11px Arial,Helvetica,sans-serif"},chartArea:{width:447,height:250}})}(e),e}).then(function(e){return function(e){var t={},a=[];e.forEach(function(e){e.result_names.forEach(function(e){t[e]||(t[e]=0),t[e]+=1})});var r=[{name:"2 Points Made In The Paint",id:1,color:"#ffbc4e"},{name:"2 Points Attempt In The Paint",id:17,color:"#7a9720"},{name:"2 Points Made Out Of The Paint",id:2,color:"#ff832e"},{name:"2 Points Attempt Out Of The Paint",id:18,color:"#ffa22f"},{name:"3 Points Made",id:3,color:"#597a2a"},{name:"3 Points Attempt",color:"#adb325",id:19}],i=0;for(var o in t)i+=t[o];for(var o in t)a.push({category:o,value:t[o]}),r.filter(function(e){return e.name===o})[0].sum=100*t[o]/i;n.links=r,$("#shot_type-pie").kendoChart({title:{position:"top",margin:{top:1,right:1,bottom:1,left:1},padding:{top:1,right:1,bottom:1,left:1}},legend:{visible:!1},chartArea:{background:"transparent",height:300,width:500},seriesDefaults:{labels:{visible:!1}},series:[{type:"pie",data:a}],tooltip:{visible:!0,background:"#000000",color:"#ffffff",padding:5,template:"${value} shots - ${data.category}",font:"13px Arial,Helvetica,sans-serif"}})}(e),e}).then(function(e){var t;return t=e,setTimeout(function(){var e=[];t.forEach(function(t){var a={name:null===t.name?t.attempts+" other":t.attempts+" "+t.name,data:[t.attempts],color:"#"+(16777215*Math.random()<<0).toString(16),labels:{visible:!0}};e.push(a)}),$(".shot-analysis").kendoChart({valueAxis:{labels:{font:"10px Arial,Helvetica,sans-serif"}},title:{text:"Shot Analysis",font:"15px Arial,Helvetica,sans-serif",color:"black",align:"center"},legend:{font:"11px Arial,Helvetica,sans-serif",position:"right"},series:e,tooltip:{visible:!0,background:"#000000",color:"#ffffff",padding:5,template:"${series.name.split(' ').slice(1).join(' ')} - ${value}",font:"11px Arial,Helvetica,sans-serif"}})},1e3),e}).then(function(e){var t;t=e.filter(function(e){return Boolean(e.name)}),setTimeout(function(){for(var e=0;e<t.length;e++)new JustGage({id:"shot-chart-"+e,value:t[e].made/t[e].attempts*100,min:0,max:100,label:" % ",levelColors:["#bc0202","#cdc720","#257f36"]});$(".shot-chart-title").show(),$(".shot-chart-footer").show()},1100)}),i.getBasketPoints(n.player,t,r).then(function(e){var t;t=e,$(".point-shots-chart").kendoChart({valueAxis:{labels:{font:"10px Arial,Helvetica,sans-serif"}},title:{text:"Points and Shots",font:"15px Arial,Helvetica,sans-serif",color:"black",align:"center"},legend:{font:"10px Arial,Helvetica,sans-serif",position:"right"},series:[{name:t[0].shots+" Shots",data:[t[0].shots],color:"#"+(16777215*Math.random()<<0).toString(16),labels:{visible:!0}},{name:t[0].points+" Points",data:[t[0].points],color:"#"+(16777215*Math.random()<<0).toString(16),labels:{visible:!0}},{name:t[0].baskets+" Baskets",data:[t[0].baskets],color:"#"+(16777215*Math.random()<<0).toString(16),labels:{visible:!0}},{name:t[0].ft_made+" FT Made",data:[t[0].ft_made],color:"#"+(16777215*Math.random()<<0).toString(16),labels:{visible:!0}},{name:t[0].ft_attempt+" FT Miss",data:[t[0].ft_attempt],color:"#"+(16777215*Math.random()<<0).toString(16),labels:{visible:!0}}],tooltip:{visible:!0,background:"#000000",color:"#ffffff",padding:5,template:"${series.name.split(' ').slice(1).join(' ')} - ${value}",font:"11px Arial,Helvetica,sans-serif"},chartArea:{width:400,height:250}})}),i.getAssistAnalysis(n.player,t,r).then(function(e){var t;t=e,setTimeout(function(){for(var e=[],a=0;a<t.length;a++){var n={name:null===t[a].name?t[a].count+" other":t[a].count+" "+t[a].name,data:[t[a].count],color:"#"+(16777215*Math.random()<<0).toString(16),labels:{visible:!0}};e.push(n)}$(".assist-analysis").kendoChart({valueAxis:{labels:{font:"10px Arial,Helvetica,sans-serif"}},title:{text:"Assists Analysis",font:"15px Arial,Helvetica,sans-serif",color:"black"},legend:{font:"10px Arial,Helvetica,sans-serif",position:"right"},series:e,tooltip:{visible:!0,background:"#000000",color:"#ffffff",padding:5,template:"${series.name.split(' ').slice(1).join(' ')} - ${value}",font:"11px Arial,Helvetica,sans-serif"}})},1e3)}),i.getTurnoverAnalysis(n.player,t,r).then(function(e){var t;t=e,setTimeout(function(){for(var e=[],a=0;a<t.length;a++){var n={name:null===t[a].name?t[a].count+" other":t[a].count+" "+t[a].name,data:[t[a].count],color:"#"+(16777215*Math.random()<<0).toString(16),labels:{visible:!0}};e.push(n)}$(".turnover-analysis").kendoChart({valueAxis:{labels:{font:"10px Arial,Helvetica,sans-serif"}},title:{text:"Turnover Analysis",font:"15px Arial,Helvetica,sans-serif",color:"black"},legend:{font:"10px Arial,Helvetica,sans-serif",position:"right"},series:e,tooltip:{visible:!0,background:"#000000",color:"#ffffff",padding:5,template:"${series.name.split(' ').slice(1).join(' ')} - ${value}",font:"11px Arial,Helvetica,sans-serif"}})},1e3)})}},n.speedIndex=1,n.indexVideo=!0,n.controlSecondButtons=function(e){document.getElementById("game_video_watch").currentTime+=Number(e)},n.controlSpeedButtons=function(e){n.speedIndex+=Number(e);var t=document.getElementById("game_video_watch");n.speedIndex<.2&&(n.speedIndex=.2),t.playbackRate=n.speedIndex},n.controlSpeedNormalButtons=function(){n.speedIndex=1,n.indexVideo=!0,document.getElementById("game_video_watch").playbackRate=n.speedIndex},n.controlPlayPause=function(){var e=document.getElementById("game_video_watch");n.indexVideo?e.play():e.pause(),n.indexVideo=!n.indexVideo},n.handleModal=function(e,t){e=t?e.target.dataset.id:e,o.getBoxScore(e).then(function(e){n.boxScore=e,e.game_stats[0].team===e.away_team.id?(n.bsHomeTeam=e.game_stats[1],n.bsAwayTeam=e.game_stats[0]):(n.bsHomeTeam=e.game_stats[0],n.bsAwayTeam=e.game_stats[1])})},n.playClips=function(e,t,a){e&&!t?i.getPlayerVideos(n.player,n.seasonquery,n.gamesquery,e).then(function(e){_(e)}):t&&a?i.getPlayerVideos(n.player,n.seasonquery,n.gamesquery,e,t).then(function(e){_(e.filter(function(e){return 1===e.action}),a)}):i.getPlayerVideos(n.player,n.seasonquery,n.gamesquery).then(function(e){_(e)})},n.playClipsPlayer=function(e,t,a){i.getPlayerVideos(n.player,n.seasonquery,n.gamesquery,e).then(function(e){_(e.filter(function(e){return 1===e.action&&e.action_result===t}),a)})},n.changeClip=function(e){n.currentVideo=e},n.nextClip=function(){var e=n.videos.indexOf(n.currentVideo);e>=19||(n.currentVideo=n.videos[e+1])},n.prevClip=function(){var e=n.videos.indexOf(n.currentVideo);0!==e&&(n.currentVideo=n.videos[e-1])},n.videofullscreen=function(){document.getElementById("playClipsModal").classList.contains("full_screen")?document.getElementById("playClipsModal").classList.remove("full_screen"):document.getElementById("playClipsModal").classList.add("full_screen")},n.dismissModal=function(){n.videos=[],n.currentVideo="";var e=document.getElementById("clip");e.pause(),e.hidden=!0,document.removeEventListener("click",p)},n.getLeagueDataNewTab=function(e,t,a){var n="league/"+t+"/"+e+"/"+a.replace(/ /g,"_");s.open(n,"_blank")},n.getTeamDataNewTab=function(e,t,a,n){var r="team/"+a+"/"+t+"/"+e+"/"+n.replace(/ /g,"_");s.open(r,"_blank")},n.getLeagueNameTab=function(e,t,a){var n="league/"+t+"/"+e+"/"+a.replace(/ /g,"_");s.open(n,"_blank")},n.getHomeTeamNameTab=function(e,t,a,n){var r="team/"+a+"/"+t+"/"+e+"/"+n.replace(/ /g,"_");s.open(r,"_blank")},n.getAwayTeamNameTab=function(e,t,a,n){var r="team/"+a+"/"+t+"/"+e+"/"+n.replace(/ /g,"_");s.open(r,"_blank")}}app.controller("PlayerSearchController1",["$location","$timeout","$rootScope","$scope","$compile","PlayerSearchService","TeamInformation","$window",PlayerProfileController]);